<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head   >
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

  <title>Profile</title>


  <meta name="description" content="Most Powerful &amp; Comprehensive Bootstrap 5 HTML Admin Dashboard Template built for developers!" />
  <meta name="keywords" content="dashboard, bootstrap 5 dashboard, bootstrap 5 design, bootstrap 5">
  <!-- Canonical SEO -->
  <link rel="canonical" href="https://themeselection.com/item/sneat-bootstrap-html-admin-template/">


  <!-- ? PROD Only: Google Tag Manager (Default ThemeSelection: GTM-5DDHKGP, PixInvent: GTM-5J3LMKC) -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5DDHKGP');</script>
  <!-- End Google Tag Manager -->

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" th:href="@{/img/favicon/favicon.ico}" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" th:href="@{/vendor/fonts/boxicons.css}" />
  <link rel="stylesheet" th:href="@{/vendor/fonts/fontawesome.css}" />
  <link rel="stylesheet" th:href="@{/vendor/fonts/flag-icons.css}"  />

  <!-- Core CSS -->
  <link rel="stylesheet" th:href="@{/vendor/css/rtl/core.css}"  class="template-customizer-core-css" />
  <link rel="stylesheet" th:href="@{/vendor/css/rtl/theme-default.css}"  class="template-customizer-theme-css" />
  <link rel="stylesheet" th:href="@{/css/demo.css}"  />

  <!-- Vendors CSS -->
  <link rel="stylesheet" th:href="@{/vendor/libs/perfect-scrollbar/perfect-scrollbar.css}"  />
  <link rel="stylesheet" th:href="@{/vendor/libs/typeahead-js/typeahead.css}"  />
  <link rel="stylesheet" th:href="@{/vendor/libs/apex-charts/apex-charts.css}"  />
  <link rel="stylesheet" th:href="@{/vendor/libs/quill/typography.css}" >
  <link rel="stylesheet" th:href="@{/vendor/libs/quill/katex.css}" >
  <link rel="stylesheet" th:href="@{/vendor/libs/quill/editor.css}" >
  <link rel="stylesheet" th:href="@{/vendor/libs/select2/select2.css}" >
  <link rel="stylesheet" th:href="@{/vendor/libs/dropzone/dropzone.css}" >
  <link rel="stylesheet" th:href="@{/vendor/libs/flatpickr/flatpickr.css}" >
  <link rel="stylesheet" th:href="@{/vendor/libs/tagify/tagify.css}"  />

  <!-- Page CSS -->
  <link rel="stylesheet" th:href="@{/vendor/css/pages/card-analytics.css}"  />

  <!-- Helpers -->
  <script th:src="@{/vendor/js/helpers.js}"></script>
  <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
  <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
  <script th:src="@{/vendor/js/template-customizer.js}"></script>
  <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
  <!--    <script th:src="@{/js/config.js}"></script>-->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&display=swap" rel="stylesheet">

  <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" type="text/css" th:href="@{/css/font-awesome.css}">
  <link rel="stylesheet" th:href="@{/css/templatemo-hexashop.css}">
  <link rel="stylesheet" th:href="@{/css/owl-carousel.css}">
  <link rel="stylesheet" th:href="@{/css/lightbox.css}">

</head>


<body>

<!-- ***** Preloader Start ***** -->
<div id="preloader">
  <div class="jumper">
    <div></div>
    <div></div>
    <div></div>
  </div>
</div>
<!-- ***** Preloader End ***** -->


<!-- ***** Header Area Start ***** -->
<div th:replace="fragments :: user_nav" />
<!-- ***** Header Area End ***** -->


<!-- ***** edit profile ***** -->

<div class="container-xxl flex-grow-1 container-p-y">


  <h4 class="py-3 mb-4">
    <span class="text-muted fw-light">Account Settings /</span> Account
  </h4>
  <form th:action="@{/user/placeOrderBuy}" method="post" id="checkoutForm">
  <div class="row">
    <div class="col-md-6">
      <p>Select your preferable address</p>
      <div class="row mb-3">
        <div class="col-md mb-md-0 mb-2" th:each="address : ${address}">
          <div class="form-check custom-option custom-option-basic checked">
            <label class="form-check-label custom-option-content" for="customRadioAddress1">
              <input name="selectedAddressId" class="form-check-input" type="radio" th:value="${address.id}" id="customRadioAddress1" checked="">
              <span class="custom-option-header mb-2">
                      <h4 th:text="${address.name}"></h4>
                    </span>
              <span class="custom-option-body">
                                <h6 th:text="${address.housename}"></h6>
                                <h6 th:text="${address.street}"></h6>
                                <h6 th:text="${address.city}"></h6>
                                <h6 th:text="${address.state}"></h6>
                                <h6 th:text="${address.landmark}"></h6>
                                <h6 th:text="${address.pincode}"></h6>
                                <h6 th:text="${address.mobile}"></h6>


                      <span class="my-2 border-bottom d-block"></span>
                      <span class="d-flex">
                        <a class="me-2" th:href="@{'/user/editAddress/' + ${address.id}}">Edit</a> <a th:href="@{'/user/removeAddress/' + ${address.id}}">Remove</a>
                      </span>
                    </span>
            </label>
          </div>
        </div>
        <a class="me-2" href="/user/addaddress">Add new address</a>
      </div>
    </div>
    <div class="col-md-6">

      <div class="row mb-3">
        <div class="col-md mb-md-0 mb-2">
          <div class="form-check custom-option custom-option-basic checked">
            <label class="form-check-label custom-option-content" for="customRadioAddress1">
              <input type="radio" id="onlinePay" name="paymentMethod" value="RAZORPAY" class="form-check-input" >
              <span class="custom-option-header mb-2">
                      <span class="fw-medium mb-0">RAZORPAY</span>
                    </span>
            </label>
          </div>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md mb-md-0 mb-2">
          <div class="form-check custom-option custom-option-basic checked">
            <label class="form-check-label custom-option-content" for="customRadioAddress1">
              <input type="radio" id="cashOnDelivery" name="paymentMethod" value="COD" class="form-check-input" checked>
              <span class="custom-option-header mb-2">
                      <span class="fw-medium mb-0">COD</span>
                    </span>
            </label>
          </div>
        </div>
      </div>


    </div>
    <div class="col-md-6">
      <div class="border rounded p-4">

        <!-- Price Details -->
        <h6>Price Details</h6>
        <dl class="row">

          <dt class="col-6 fw-normal">Order Total</dt>
          <dd class="col-6 text-end">$1198.00</dd>

          <dt class="col-6 fw-normal">Delivery Charges</dt>
          <dd class="col-6 text-end"><s class="text-muted">$5.00</s> <span class="badge bg-label-success ms-1">Free</span></dd>
        </dl>
        <hr class="mx-n4">
        <dl class="row">
          <dt class="col-6 mb-3">Total</dt>
<!--          <dd id="cartTotal" class="col-6 fw-medium text-end mb-0" th:text="'₹' + ${total}">$1198.00</dd>-->
          <span id="cartTotal"><strong>₹<span th:text="${total}"></span></strong></span>
        </dl>
      </div>
      <div class="d-grid mt-3">
        <button type="submit" id="placeOrderButton" class="btn btn-primary btn-block waves-effect waves-light">Place Order</button>

      </div>
      <div class="d-grid mt-3">
      <button id="paymentPlaceOrderButton" class="btn btn-primary btn-block waves-effect waves-light" style="display:none;">Payment Place Order</button>
      </div>
    </div>
  </div>
  </form>
</div>


<!-- ***** edit profile ***** -->


<!-- ***** Footer Start ***** -->
<div th:replace="fragments :: user_foot" />


<!-- jQuery -->
<script th:src="@{/js/jquery-2.1.0.min.js}"></script>

<!-- Bootstrap -->
<script th:src="@{/js/popper.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>

<!-- Plugins -->
<script th:src="@{/js/owl-carousel.js}"></script>
<script th:src="@{/js/accordions.js}"></script>
<script th:src="@{/js/datepicker.js}"></script>
<script th:src="@{/js/scrollreveal.min.js}"></script>
<script th:src="@{/js/waypoints.min.js}"></script>
<script th:src="@{/js/jquery.counterup.min.js}"></script>
<script th:src="@{/js/imgfix.min.js}"></script>
<script th:src="@{/js/slick.js}"></script>
<script th:src="@{/js/lightbox.js}"></script>
<script th:src="@{/js/isotope.js}"></script>

<!-- Global Init -->
<script th:src="@{/js/custom.js}"></script>

<script>
  const cashOnDeliveryRadio = document.getElementById('cashOnDelivery'); // Updated ID
const onlinePayRadio = document.getElementById('onlinePay'); // Updated ID
const placeOrderButton = document.getElementById('placeOrderButton');
const paymentPlaceOrderButton = document.getElementById('paymentPlaceOrderButton'); // Corrected typo
const checkoutForm = document.getElementById('checkoutForm');

paymentPlaceOrderButton.addEventListener('click', (event) => {
    event.preventDefault();
    paymentStart();
});

cashOnDeliveryRadio.addEventListener('change', () => {
    placeOrderButton.style.display = 'block';
    paymentPlaceOrderButton.style.display = 'none';
});

onlinePayRadio.addEventListener('change', () => {
    placeOrderButton.style.display = 'none';
    paymentPlaceOrderButton.style.display = 'block';
});
</script>


<script>
  const paymentStart = () => {
      console.log("Payment Started...");
      let amount = $("#cartTotal span").text();
      console.log(amount);

      if(amount == "" || amount == null) {
      alert("amount is required");
      swal("Sorry!", "amount is required", "error");
      return;
      }

      $.ajax(
          {
              url:"/user/create_order",
              data:JSON.stringify({amount:amount, info:"order_request"}),
              contentType: "application/json",
              type:"POST",
              dataType: "json",
              success:function(response){
                  //invoked when success
                  console.log(response);
                  if(response.status == "created") {
                      //open payment form
                      let options = {
                          key: "rzp_test_SFjHv4xXWflKId",
                          amount:response.amount,
                          currency:"INR",
                          name:"Eccentric",
                          description:"Eccentric Online Payment",
                          //image:"";
                          order_id:response.id,
                          handler:function(response){
                              console.log(response.razorpay_payment_id);
                              console.log(response.razorpay_order_id);
                              console.log(response.razorpay_signature);
                              console.log("payment successful!");
                              //alert("congratulations! Payment successful.");
                              updatePaymentOnServer(response.razorpay_payment_id,
                               response.razorpay_order_id,
                               'paid');

                              checkoutForm.submit();
                          },
                          prefill: {
                              name: "",
                              email: "",
                              contact: ""
                          },
                          notes: {
                              address: "Eccentric Office"
                          },
                          theme: {
                              color: "#3399cc"
                          }
                      };

                      let rzp = new Razorpay(options);
                      rzp.on('payment.failed', function (response){
                          console.log(response.error.code);
                          console.log(response.error.description);
                          console.log(response.error.source);
                          console.log(response.error.step);
                          console.log(response.error.reason);
                          console.log(response.error.metadata.order_id);
                          console.log(response.error.metadata.payment_id);
                          //alert("Oops payment failed!");
                          swal("Sorry!", "Oops payment failed!", "error");
                      });
                      rzp.open();
                  }
              },
              error:function(error){
                  //invoked when unsuccessful
                  console.error(error);
                  //alert("something went wrong!!");
                  swal("Sorry!", "something went wrong!!", "error");
              }
          }
      )
  };

  function updatePaymentOnServer(payment_id, order_id, status)
  {
      $.ajax({
          url:"/update_order",
              data:JSON.stringify({payment_id: payment_id, order_id: order_id, status: status}),
              contentType: "application/json",
              type:"POST",
              dataType: "json",
              success:function(response){
                  swal("Good Job!", "congratulations!, payment successful", "success");
              },
              error:function(error){
                  swal("Sorry!", "Oops payment failed!", "error");
              },
      })
  }
</script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js" integrity="sha512-AA1Bzp5Q0K1KanKKmvN/4d3IRKVlv9PYgwFPvm32nPO6QS8yH1HO7LbgB1pgiOxPtfeg5zEn2ba64MUcqJx6CA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>












<script>

  $(function() {
      var selectedClass = "";
      $("p").click(function(){
      selectedClass = $(this).attr("data-rel");
      $("#portfolio").fadeTo(50, 0.1);
          $("#portfolio div").not("."+selectedClass).fadeOut();
      setTimeout(function() {
        $("."+selectedClass).fadeIn();
        $("#portfolio").fadeTo(50, 1);
      }, 500);

      });
  });

</script>




</body>
</html>